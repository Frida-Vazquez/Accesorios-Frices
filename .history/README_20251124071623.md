# Accesorios Frices

API base con **Express** usando patr√≥n **MVC** (+ capa de **servicios** y **repositorios**), validaci√≥n con **Zod**, acceso a datos con **mysql2/promise** y autenticaci√≥n con **JWT**.

Pensada como boilerplate sencillo para:

- Crear y administrar **clientes**.
- Realizar **login** con email + contrase√±a.
- Proteger rutas mediante **tokens JWT**.

---

## üß± Stack Tecnol√≥gico

- Node.js (ESM)
- Express 5
- mysql2/promise (pool + prepared statements)
- Zod (validaci√≥n de entrada)
- bcryptjs (hash de contrase√±as)
- JSON Web Token (jsonwebtoken)
- Nodemon (desarrollo)

---

## ‚úÖ Requisitos Previos

- **Node.js** ‚â• 18  
- **MySQL** 8.x o **MariaDB** equivalente  
- Usuario MySQL con permisos para:
  - Crear bases de datos
  - Crear tablas
  - Insertar datos

Opcional:

- **MySQL Workbench**, HeidiSQL u otra GUI

---

## üìÅ Estructura del Proyecto

```text
src/
  app.js
  server.js
  routes/
    index.js
    auth.routes.js
    clientes.routes.js
  controllers/
    auth.controller.js
    cliente.controller.js
  services/
    auth.service.js
    cliente.service.js
  repositories/
    cliente.repository.js
  models/
    auth.model.js
    cliente.model.js
  middlewares/
    auth.js
    errorHandler.js
    notFound.js
  utils/
    db.js

bd/
  accesorios_frices.sql

.env        # se crea manualmente (no se versiona)

‚öôÔ∏è Configuraci√≥n
1. Clonar el repositorio
git clone <URL_DEL_REPOSITORIO>
cd <carpeta_del_proyecto>

2. Instalar dependencias
npm install

3. Crear la base de datos (script bd/accesorios_frices.sql)

Dentro del proyecto tienes:

bd/accesorios_frices.sql


Este script:

Crea la base de datos AccesoriosFrices

Crea la tabla clientes

Inserta un cliente demo con contrase√±a hasheada

üü£ Opci√≥n A: CLI MySQL
mysql -u <tu_usuario> -p < ./bd/accesorios_frices.sql

üü£ Opci√≥n B: Workbench / HeidiSQL

Abrir Workbench

Conectarte a MySQL

Abrir accesorios_frices.sql

Ejecutar todo el script

Al finalizar tendr√°s:

Base de datos: AccesoriosFrices

Tabla: clientes

Cliente demo:

email: fernando@hotmail.com
password: 12345678

4. Crear archivo .env

En la ra√≠z del proyecto crea un archivo .env con:

# Servidor HTTP
PORT=3000

# Base de datos MySQL
MYSQL_HOST=127.0.0.1
MYSQL_PORT=3307
MYSQL_USER=root
MYSQL_PASSWORD=root2025
MYSQL_DB=frices_db
MYSQL_CONN_LIMIT=10

# Autenticaci√≥n JWT
JWT_SECRET=254b607ee763b7b4efad1496904fcfae54dbd6a2a0fe5f8c950517ba92801d09
JWT_EXPIRES_IN=1h

üîê Importante:

No subas tu .env a GitHub

Cambia el secreto JWT para producci√≥n

üöÄ Ejecuci√≥n
Desarrollo (con recarga autom√°tica)
npm run dev


La API escuchar√° en:

http://localhost:3000/

Producci√≥n / ejecuci√≥n simple
npm start
# o:
node src/server.js

üîå Endpoints Principales
Health
GET /
GET /api/health

Ejemplo de respuesta:

{
  "status": "ok",
  "time": "2025-11-21T..."
}

üîê Autenticaci√≥n
POST /api/auth/login

Permite iniciar sesi√≥n y obtener un JWT.

Body:
{
  "email": "fernando@hotmail.com",
  "password": "12345678"
}

Respuesta:
{
  "token": "JWT_AQUI",
  "user": {
    "id": 1,
    "nombre": "Cliente Demo",
    "email": "fernando@hotmail.com"
  }
}


Usar en rutas protegidas:

Authorization: Bearer JWT_AQUI

üë• Clientes (protegido con JWT)

Todas las rutas requieren:

Authorization: Bearer <tu_token_jwt>

GET /api/clientes

Lista paginada de clientes.

Query params opcionales:

limit

offset

Ejemplo:

GET /api/clientes?limit=10&offset=0
Authorization: Bearer <token>

GET /api/clientes/:id

Obtiene un cliente por su ID.

POST /api/clientes

Crea un nuevo cliente.

{
  "nombre": "Nuevo Cliente",
  "email": "nuevo@example.com",
  "password": "unaClave123",
  "activo": true
}

PATCH /api/clientes/:id

Actualiza parcialmente los datos de un cliente.

DELETE /api/clientes/:id

Elimina o desactiva un cliente.

üë§ Autor

Frida V√°zquez de la Cruz
Instituto Tecnol√≥gico de Tuxtla Guti√©rrez
Materia: E-Business (7¬∞ semestre)