<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Accesorios Frices - Registro y Login</title>

    <!-- ARCHIVO CSS EXTERNO -->
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>

<div class="container">
    <h2>Crear Cuenta</h2>

    <input id="reg-nombre" placeholder="Nombre Completo" />
    <input id="reg-email" placeholder="Correo" type="email" />
    <input id="reg-pass" placeholder="ContraseÃ±a" type="password" />

    <button onclick="registrar()">Registrarse</button>
    <div id="msg-registro" class="msg"></div>
</div>

<div class="container" style="margin-left: 20px;">
    <h2>Iniciar SesiÃ³n</h2>

    <input id="log-email" placeholder="Correo" type="email" />
    <input id="log-pass" placeholder="ContraseÃ±a" type="password" />

    <button onclick="login()">Login</button>
    <div id="msg-login" class="msg"></div>

    <div id="token-box" class="token-box" style="display:none;"></div>
</div>


<script>
    const API_URL = "http://localhost:3000/api";

    // ===============================
    // REGISTRO (nombre, email, password)
    // ===============================
    async function registrar() {
        const nombre = document.getElementById("reg-nombre").value;
        const email = document.getElementById("reg-email").value;
        const pass = document.getElementById("reg-pass").value;

        const res = await fetch(`${API_URL}/clientes`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                nombre: nombre,     // ðŸ‘ˆ Zod lo pide asÃ­
                email: email,       // ðŸ‘ˆ Zod lo pide asÃ­
                password: pass      // ðŸ‘ˆ Zod lo pide asÃ­
            })
        });

        const data = await res.json();

        document.getElementById("msg-registro").innerText =
            res.ok ? "Registro exitoso ðŸŽ‰" : (data.message || "Error al registrar");
    }

    // ===============================
    // LOGIN (email, password)
    // ===============================
    async function login() {
        const email = document.getElementById("log-email").value;
        const pass = document.getElementById("log-pass").value;

        const res = await fetch(`${API_URL}/auth/login`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                email: email,        // ðŸ‘ˆ tu backend lo pide asÃ­
                password: pass
            })
        });

        const data = await res.json();

        if (res.ok) {
            document.getElementById("msg-login").innerText = "Login correcto âœ”";
            localStorage.setItem("token", data.token);

            document.getElementById("token-box").style.display = "block";
            document.getElementById("token-box").innerText = data.token;
        } else {
            document.getElementById("msg-login").innerText =
                data.message || "Error en login";
        }
    }
</script>

</body>
</html>
