<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Accesorios Frices - Auth</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>

<div class="auth-wrapper">
    <div class="auth-card">
        <div class="auth-tabs">
            <button id="tab-login" class="tab active" onclick="showLogin()">Login</button>
            <button id="tab-register" class="tab" onclick="showRegister()">Register</button>
        </div>

        <!-- LOGIN -->
        <div id="login-form" class="form-panel active">
            <h2 class="auth-title">Iniciar SesiÃ³n</h2>

            <input id="log-email" class="auth-input" placeholder="Correo" type="email" />
            <input id="log-pass" class="auth-input" placeholder="ContraseÃ±a" type="password" />

            <button class="auth-button" onclick="login()">Login</button>
            <div id="msg-login" class="auth-msg"></div>

            <button class="link-button" type="button">Â¿Olvidaste tu contraseÃ±a?</button>
        </div>

        <!-- REGISTER -->
        <div id="register-form" class="form-panel">
            <h2 class="auth-title">Crear Cuenta</h2>

            <input id="reg-nombre" class="auth-input" placeholder="Nombre completo" />
            <input id="reg-email" class="auth-input" placeholder="Correo" type="email" />
            <input id="reg-pass" class="auth-input" placeholder="ContraseÃ±a" type="password" />

            <button class="auth-button" onclick="registrar()">Registrarse</button>
            <div id="msg-registro" class="auth-msg"></div>
        </div>

        <!-- TOKEN (debug / para el profe) -->
        <div id="token-box" class="token-box" style="display:none;"></div>
    </div>
</div>

<script>
    const API_URL = "http://localhost:3000/api";

    // Cambiar pestaÃ±as
    function showLogin() {
        document.getElementById("login-form").classList.add("active");
        document.getElementById("register-form").classList.remove("active");

        document.getElementById("tab-login").classList.add("active");
        document.getElementById("tab-register").classList.remove("active");
    }

    function showRegister() {
        document.getElementById("login-form").classList.remove("active");
        document.getElementById("register-form").classList.add("active");

        document.getElementById("tab-login").classList.remove("active");
        document.getElementById("tab-register").classList.add("active");
    }

    // REGISTRO
    async function registrar() {
        const nombre = document.getElementById("reg-nombre").value;
        const email = document.getElementById("reg-email").value;
        const pass = document.getElementById("reg-pass").value;

        const res = await fetch(`${API_URL}/clientes`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                nombre: nombre,
                email: email,
                password: pass
            })
        });

        const data = await res.json();

        document.getElementById("msg-registro").innerText =
            res.ok ? "Registro exitoso ðŸŽ‰" : (data.message || "Error al registrar");
    }

    // LOGIN
    async function login() {
        const email = document.getElementById("log-email").value;
        const pass = document.getElementById("log-pass").value;

        const res = await fetch(`${API_URL}/auth/login`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                email: email,
                password: pass
            })
        });

        const data = await res.json();

        if (res.ok) {
            document.getElementById("msg-login").innerText = "Login correcto âœ”";
            localStorage.setItem("token", data.token);

            const box = document.getElementById("token-box");
            box.style.display = "block";
            box.innerText = data.token;
        } else {
            document.getElementById("msg-login").innerText =
                data.message || "Error en login";
        }
    }
</script>

</body>
</html>
